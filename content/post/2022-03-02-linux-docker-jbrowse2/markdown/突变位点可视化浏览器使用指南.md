# 突变位点可视化浏览器工具使用指南

本文将介绍突变位点可视化工具——JBrowse2的使用，主要针对简单的突变类型，包括SNV，INDEL等，请务必使用`chrome`浏览器打开。

[TOC]

---

## 突变位点链接

商检项目注释文件中![image-20201222171251342](https://gitee.com/Ava_Zhao/gallery/raw/master/20201222171251.png)和![image-20201222171304668](https://gitee.com/Ava_Zhao/gallery/raw/master/20201222171304.png)两个表单中最后一列为url，如下图：

![image-20201222171607581](https://gitee.com/Ava_Zhao/gallery/raw/master/20201222171607.png)

将图中链接贴入浏览器地址栏回车即可定位到对应行记录的突变位点对应的基因组位置。

常规情况下每一个链接由五部分组成，依次为Gene_refGene、CSN_nuc_change、CSN_AA_change、Chr、Start、End，以下划线分隔。除此以外有以下特例：

1. 某些突变位点没有氨基酸改变的信息，则链接中对应位置为NA
2. 某些项目一个突变位点不止对应一个基因，当对应基因过多时，链接由3部分组成，依次为Chr、Start、End
3. 某些突变位点对应的位置不只有1个（如95237025:95237066)，则在链接中只保留第一个位置，基因组定位也定位在这个位置

## 添加track

回车后见到如下页面：

![image-20201222172539883](https://gitee.com/Ava_Zhao/gallery/raw/master/20201222172540.png)

如上图蓝框中所示，基因组已经定位到链接中指向的位置。

点击SELECT TRACKS![image-20201223131305453](../../AppData/Roaming/Typora/typora-user-images/image-20201223131305453.png)弹出如下track选择框：

![image-20201223131647911](https://gitee.com/Ava_Zhao/gallery/raw/master/20201223131648.png)

点选参考基因组，以及tumor和/或normal的bam文件，等待reads以及coverage histogram加载到窗口中即可。

## 线性基因组视图

![image-20201223134617391](https://gitee.com/Ava_Zhao/gallery/raw/master/20201223134617.png)

在浏览器窗口视图中可以像IGV中一样，在搜索框中输入位置，回车即可定位到想要查看的位置，如：`chr1:1-100 `或 `chr1:1..100`，但是目前还不支持按照基因名称搜索。

1. 左右拖拽

   类似于IGV，在jbrowse中可以鼠标左键按住后拖拽视图，查看周围的序列和reads。

2. 缩放

   如图中红框，在LGV顶部有缩放按钮和滑条：

   ![image-20201119163013784](https://gitee.com/Ava_Zhao/gallery/raw/master/20201119163013.png)

3. 窗口重排

   在每一个track窗口的左上角有一个圆角矩形标签：

   ![image-20201119163346247](https://gitee.com/Ava_Zhao/gallery/raw/master/20201119163346.png)

   点击左侧的六个小点既可以拖拽重排track。

## 比对track参数设置

### 显示中心线

点击左上角三条横线处菜单![image-20201228093444857](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228093444.png)后如图勾选【Show center line】：

![image-20201228093545284](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228093545.png)

将需要排序的碱基位置拉到center line中间。

### reads排序

点击track label右侧![image-20201228093659732](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228093659.png)三个竖排圆点后如图点击【Sort by→Base pair】：

![image-20201228093906123](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228093906.png)

### 显示soft clipping

![image-20201228093942361](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228093942.png)

如上图，勾选track 菜单中的【Show soft clipping】。

<span style="color:#DD5044;font-weight:bold">注：请尽量不要打开这个功能</span>

## 突变类型（均需显示中心线且排序后查看）

### SNV

SNV的表现形式如下：

![image-20201228095423820](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228095424.png)

### Insertion

Insertion的表现形式如下：

![image-20201228095945463](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228095945.png)

图中`I(s3)`及`I(3)`都表示插入，sn中s表示soft clipping，n表示碱基个数，仅有数字的，n表示插入碱基个数。但JBrowse2目前还不支持查看插入序列。

### Deletion

Deletion的表现形式如下：

![image-20201228094524586](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228094524.png)

查看coverage详细信息能看到对比左右碱基该位置碱基Count减少：

![image-20201228094635213](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228094635.png)

![image-20201228094726741](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228094726.png)

![image-20201228094853432](https://gitee.com/Ava_Zhao/gallery/raw/master/20201228094853.png)

















